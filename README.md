# Screen Time Tracker for Parents

ScreenTracker for fsp hacaton

Python-приложение для Windows, которое считает активное экранное время, делает почасовые скриншоты, отправляет ежедневный email-отчет родителю и напоминает о мягких лимитах. Работает в фоне и может запускаться вместе с системой.

## Возможности
- Автозапуск через Startup (скрипт `scripts/install_autostart.py`).
- Фоновый режим: трэй-иконка с быстрыми действиями (отправить отчет, открыть папку данных, выход).
- Подсчет активного времени с учетом пауз > 5 минут (настраивается).
- Почасовые скриншоты (включено по умолчанию).
- Ежедневный отчет в 20:00 на email: общее время + разбивка по приложениям.
- Мягкие лимиты и напоминания о перерывах (уведомления через Windows toast).
- Дополнительно: раздельное время по приложениям, переключаемый язык (RU/EN), двуязычные отчеты при выборе `both`.

## Быстрый запуск (dev-режим)
1. Установите Python 3.10+ и Git.
2. Клонируйте проект и установите зависимости:
   ```bash
   python -m venv .venv
   .venv\Scripts\activate
   pip install -r requirements.txt
   ```
3. Заполните файл `env` (лежит рядом) своими значениями.
4. Запустите трекер:
   ```bash
   python main.py
   ```
   Иконка появится в системном трее; приложение будет в фоне.

## Настройки (env/переменные)
- `idle_minutes`: минут бездействия до паузы таймера (по умолчанию 5).
- `report_time`: время отправки ежедневного отчета в формате `HH:MM` (24h).
- `parent_email`: адрес родителя для отчетов.
- `warning_minutes`: мягкое предупреждение «сделай паузу» (минуты непрерывной активности до уведомления).
- `soft_limit_minutes`: мягкий дедлайн «заканчиваем скоро» (после него приходит уведомление подготовиться завершить работу).
- `hard_limit_minutes`: жесткий дедлайн «хватит на сегодня» (после него приходит уведомление остановиться совсем).
- `break_interval_minutes`: интервал регулярных напоминаний о коротком перерыве (считается по накопленному активному времени).
- `screenshot_enabled`: включить/выключить почасовые скриншоты.
- `screenshot_dir` / `data_dir`: папки для скриншотов и данных.
- `language`: `en` или `ru` для одних уведомлений/писем, `both` — двуязычный отчет.
- `smtp`: настройки почты (`host`, `port`, `user`, `password`, `use_ssl`). Используйте пароль приложения (например, Gmail App Password), не храните личный пароль в репозитории.

### Переменные окружения
- `TRACKER_PARENT_EMAIL`, `TRACKER_REPORT_TIME`, `TRACKER_IDLE_MINUTES`, `TRACKER_LANGUAGE`
- `TRACKER_SOFT_LIMIT_MINUTES`, `TRACKER_HARD_LIMIT_MINUTES`, `TRACKER_WARNING_MINUTES`, `TRACKER_BREAK_INTERVAL_MINUTES`
- `TRACKER_SCREENSHOT_ENABLED`, `TRACKER_SCREENSHOT_DIR`, `TRACKER_DATA_DIR`
- `TRACKER_SMTP_HOST`, `TRACKER_SMTP_PORT`, `TRACKER_SMTP_USER`, `TRACKER_SMTP_PASSWORD`, `TRACKER_SMTP_USE_SSL`

Файл `env` в корне уже содержит шаблон с этими ключами. Заполните свои значения (user/password/email), сохраните файл и запустите `python main.py` — приложение подхватит переменные автоматически. Если предпочитаете системные переменные, задайте их и они перекроют значения из `env`.

## Функции и расписание
- Подсчет активности: фиксируется клавиатура/мышь. При простое > `idle_minutes` таймер ставится на паузу.
- Разбивка по приложениям: используется активное окно Windows.
- Почасовые скриншоты: сохраняются в `screenshots/YYYY-MM-DD/HH-MM-SS.png`.
- Лимиты: предупреждение о паузе после `warning_minutes`, мягкий дедлайн после `soft_limit_minutes` («пора сворачиваться»), жесткий дедлайн после `hard_limit_minutes` («заканчиваем сегодня»), регулярные напоминания каждые `break_interval_minutes` активного времени.
- Ежедневная почта: в `report_time` отправляется письмо (язык RU/EN или оба — по `language`).
- Трэй-меню локализовано: «Отправить отчет»/«Send report now», «Открыть папку данных», «Выход».

## Установка автозапуска (Windows)
После настройки Python и зависимостей выполните:
```bash
python scripts/install_autostart.py
```
Скрипт создаст в `%APPDATA%\\Microsoft\\Windows\\Start Menu\\Programs\\Startup` файл `screen_time_tracker.bat`, который будет запускать `main.py` при входе пользователя.

## Сборка в исполняемый файл
PyInstaller позволяет собрать приложение в один файл без консоли:
```bash
pyinstaller --onefile --noconsole --name screen_time_tracker main.py
```
Положите итоговый `screen_time_tracker.exe` в удобное место и (опционально) добавьте ярлык в папку Startup.

## Тестирование
- Запустите `python main.py`, пошевелите мышью/клавиатурой и дождитесь накопления времени.
- Проверьте запись json-файла в `data/` и скриншоты в `screenshots/`.
- Для проверки почты укажите тестовый SMTP-аккаунт и нажмите в трее «Send report now» (или подождите времени отчета).
